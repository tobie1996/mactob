{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useLocation,useNavigate,useParams}from'react-router-dom';import productCategory from'../helpers/productCategory';import VerticalCard from'../components/VerticalCard';import SummaryApi from'../common';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CategoryProduct=()=>{const[data,setData]=useState([]);const navigate=useNavigate();const[loading,setLoading]=useState(false);const location=useLocation();const urlSearch=new URLSearchParams(location.search);const urlCategoryListinArray=urlSearch.getAll(\"category\");const urlCategoryListObject={};urlCategoryListinArray.forEach(el=>{urlCategoryListObject[el]=true;});const[selectCategory,setSelectCategory]=useState(urlCategoryListObject);const[filterCategoryList,setFilterCategoryList]=useState([]);const[sortBy,setSortBy]=useState(\"\");const fetchData=async e=>{const response=await fetch(SummaryApi.filterProduct.url,{method:SummaryApi.filterProduct.method,headers:{\"content-type\":\"application/json\"},body:JSON.stringify({category:filterCategoryList})});const dataResponse=await response.json();setData((dataResponse===null||dataResponse===void 0?void 0:dataResponse.data)||[]);};const handleSelectCategory=e=>{e.preventDefault();const{name,value,checked}=e.target;setSelectCategory(preve=>{return{...preve,[value]:checked};});};useEffect(()=>{fetchData();},[filterCategoryList]);useEffect(e=>{const arrayOfCategory=Object.keys(selectCategory).map(categoryKeyName=>{if(selectCategory[categoryKeyName]){return categoryKeyName;}return null;}).filter(el=>el);setFilterCategoryList(arrayOfCategory);//format for url change when change on the checkbox\nconst urlFormat=arrayOfCategory.map((el,index)=>{if(arrayOfCategory.length-1===index){return\"category=\".concat(el);}return\"category=\".concat(el,\"&&\");});navigate(\"/product-category?\"+urlFormat.join(\"\"));},[selectCategory]);const handleOnChangeSortBy=e=>{e.preventDefault();const{value}=e.target;setSortBy(value);if(value==='asc'){setData(preve=>preve.sort((a,b)=>a.sellingPrice-b.sellingPrice));}if(value==='dsc'){setData(preve=>preve.sort((a,b)=>b.sellingPrice-a.sellingPrice));}};useEffect(()=>{},[sortBy]);return/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto p-4\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"grid grid-cols-full lg:grid-cols-[200px,1fr] gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"bg-white p-2 overflow-y-scroll \",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"mb-4\",children:[\"  \",/*#__PURE__*/_jsx(\"h3\",{class:\"text-base uppercase font-medium text-slate-500 border-b pb-1 border-slate-300 medium\",children:\"Sort by\"}),/*#__PURE__*/_jsxs(\"form\",{class:\"text-sm flex flex-col gap-2 py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"sortBy\",checked:sortBy===\"asc\",onChange:handleOnChangeSortBy,value:\"asc\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Prix \\u200B\\u200Bcroissant\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"sortBy\",checked:sortBy===\"dsc\",onChange:handleOnChangeSortBy,value:\"dsc\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Prix - du haut au bas\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{class:\"text-base uppercase font-medium text-slate-500 border-b pb-1 border-slate-300\",children:\"Category\"}),/*#__PURE__*/_jsx(\"form\",{class:\"text-sm flex flex-col gap-2 py-2\",children:productCategory.map((categoryName,index)=>/*#__PURE__*/_jsxs(\"div\",{class:\"flex items-center gap-3\",children:[\"  \",/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"category\",checked:selectCategory[categoryName===null||categoryName===void 0?void 0:categoryName.value],value:categoryName===null||categoryName===void 0?void 0:categoryName.value,id:categoryName===null||categoryName===void 0?void 0:categoryName.value,onChange:handleSelectCategory}),/*#__PURE__*/_jsx(\"label\",{for:categoryName===null||categoryName===void 0?void 0:categoryName.value,children:categoryName===null||categoryName===void 0?void 0:categoryName.label})]},index))})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"px-4\",children:[/*#__PURE__*/_jsxs(\"p\",{class:\"font-medium text-slate-800 text-lg my-2\",children:[\"Search Results: \",data.length]}),/*#__PURE__*/_jsx(\"div\",{class:\"min-h-screen overflow-y-scroll lg:min-h-[calc(100vh-120px)] max-h-[calc(100vh-120px)]\",children:data.length!==0&&!loading&&/*#__PURE__*/_jsx(VerticalCard,{data:data,loading:loading})})]})]})});};export default CategoryProduct;","map":{"version":3,"names":["React","useEffect","useState","useLocation","useNavigate","useParams","productCategory","VerticalCard","SummaryApi","jsx","_jsx","jsxs","_jsxs","CategoryProduct","data","setData","navigate","loading","setLoading","location","urlSearch","URLSearchParams","search","urlCategoryListinArray","getAll","urlCategoryListObject","forEach","el","selectCategory","setSelectCategory","filterCategoryList","setFilterCategoryList","sortBy","setSortBy","fetchData","e","response","fetch","filterProduct","url","method","headers","body","JSON","stringify","category","dataResponse","json","handleSelectCategory","preventDefault","name","value","checked","target","preve","arrayOfCategory","Object","keys","map","categoryKeyName","filter","urlFormat","index","length","concat","join","handleOnChangeSortBy","sort","a","b","sellingPrice","className","children","class","type","onChange","categoryName","id","for","label"],"sources":["C:/Users/Wendy/OneDrive/Desktop/PROJET/MACTOB_STORE/frontend/src/pages/CategoryProduct.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useLocation, useNavigate, useParams } from 'react-router-dom'\r\nimport productCategory from '../helpers/productCategory'\r\nimport VerticalCard from '../components/VerticalCard'\r\nimport SummaryApi from '../common'\r\n\r\nconst CategoryProduct = () => {\r\n  const [data, setData] = useState([])\r\n  const navigate = useNavigate()\r\n  const [loading, setLoading] = useState(false)\r\n  const location = useLocation()\r\n  const urlSearch = new URLSearchParams(location.search)\r\n  const urlCategoryListinArray = urlSearch.getAll(\"category\")\r\n\r\n  const urlCategoryListObject = {}\r\n  urlCategoryListinArray.forEach(el => {\r\n    urlCategoryListObject[el] = true\r\n  })\r\n\r\n  const [selectCategory, setSelectCategory] = useState(urlCategoryListObject)\r\n  const [filterCategoryList, setFilterCategoryList] = useState([])\r\n\r\n  const [sortBy, setSortBy] = useState(\"\")\r\n\r\n  const fetchData = async (e) => {\r\n    const response = await fetch(SummaryApi.filterProduct.url, {\r\n      method: SummaryApi.filterProduct.method,\r\n      headers: {\r\n        \"content-type\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({\r\n        category: filterCategoryList\r\n      })\r\n    })\r\n\r\n    const dataResponse = await response.json()\r\n    setData(dataResponse?.data || [])\r\n  }\r\n\r\n  const handleSelectCategory = (e) => {\r\n    e.preventDefault()\r\n    const { name, value, checked } = e.target\r\n\r\n    setSelectCategory((preve) => {\r\n      return {\r\n        ...preve,\r\n        [value]: checked\r\n      }\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchData()\r\n  }, [filterCategoryList])\r\n\r\n  useEffect((e) => {\r\n    const arrayOfCategory = Object.keys(selectCategory).map(categoryKeyName => {\r\n      if (selectCategory[categoryKeyName]) {\r\n        return categoryKeyName\r\n      }\r\n      return null\r\n    }).filter(el => el)\r\n\r\n    setFilterCategoryList(arrayOfCategory)\r\n\r\n    //format for url change when change on the checkbox\r\n    const urlFormat = arrayOfCategory.map((el, index) => {\r\n      if ((arrayOfCategory.length - 1) === index) {\r\n        return `category=${el}`\r\n      }\r\n      return `category=${el}&&`\r\n    })\r\n\r\n    navigate(\"/product-category?\" + urlFormat.join(\"\"))\r\n  }, [selectCategory])\r\n\r\n\r\n  const handleOnChangeSortBy = (e) => {\r\n    e.preventDefault()\r\n    const { value } = e.target\r\n\r\n    setSortBy(value)\r\n\r\n    if (value === 'asc') {\r\n      setData(preve => preve.sort((a, b) => a.sellingPrice - b.sellingPrice))\r\n    }\r\n\r\n    if (value === 'dsc') {\r\n      setData(preve => preve.sort((a, b) => b.sellingPrice - a.sellingPrice))\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n\r\n  }, [sortBy])\r\n\r\n  return (\r\n    <div className='container mx-auto p-4'>\r\n\r\n      {/***desktop version */}\r\n      <div class=\"grid grid-cols-full lg:grid-cols-[200px,1fr] gap-4\">\r\n        <div class=\"bg-white p-2 overflow-y-scroll \">\r\n          <div class=\"mb-4\">  <h3 class=\"text-base uppercase font-medium text-slate-500 border-b pb-1 border-slate-300 medium\">Sort by</h3>\r\n            <form class=\"text-sm flex flex-col gap-2 py-2\">\r\n              <div class=\"flex items-center gap-3\">\r\n                <input type=\"radio\" name=\"sortBy\" checked={sortBy === \"asc\"} onChange={handleOnChangeSortBy} value=\"asc\" />\r\n                <label>Prix ​​croissant</label>\r\n              </div>\r\n              <div class=\"flex items-center gap-3\">\r\n                <input type=\"radio\" name=\"sortBy\" checked={sortBy === \"dsc\"} onChange={handleOnChangeSortBy} value=\"dsc\" />\r\n                <label>Prix - du haut au bas</label>\r\n              </div>\r\n            </form>\r\n          </div>\r\n\r\n          <div class=\"mb-4\">\r\n            <h3 class=\"text-base uppercase font-medium text-slate-500 border-b pb-1 border-slate-300\">Category</h3>\r\n            <form class=\"text-sm flex flex-col gap-2 py-2\">\r\n              {productCategory.map((categoryName, index) => (\r\n                <div class=\"flex items-center gap-3\" key={index}>  <input type=\"checkbox\" name=\"category\" checked={selectCategory[categoryName?.value]} value={categoryName?.value} id={categoryName?.value} onChange={handleSelectCategory} />\r\n                  <label for={categoryName?.value}>{categoryName?.label}</label>\r\n                </div>\r\n              ))}\r\n            </form>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"px-4\">\r\n          <p class=\"font-medium text-slate-800 text-lg my-2\">Search Results: {data.length}</p>\r\n          <div class=\"min-h-screen overflow-y-scroll lg:min-h-[calc(100vh-120px)] max-h-[calc(100vh-120px)]\">\r\n            {data.length !== 0 && !loading && (\r\n              <VerticalCard data={data} loading={loading} />\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CategoryProduct"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}