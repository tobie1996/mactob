{"ast":null,"code":"import React,{useEffect,useState}from'react';import UploadProduct from'../components/UploadProduct';import SummaryApi from'../common';import AdminProductCard from'../components/AdminProductCard';import{toast}from'react-toastify';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AllProducts=()=>{const[openUploadProduct,setOpenUploadProduct]=useState(false);const[allProduct,setAllProduct]=useState([]);const fetchAllProduct=async()=>{const token=localStorage.getItem(\"token\");const userId=JSON.parse(atob(token.split('.')[1]))._id;// Decode token to get userId\ntry{const response=await fetch(SummaryApi.allProduct.url,{method:'GET',headers:{\"content-type\":\"application/json\",Authorization:\"Bearer \".concat(token)}});const dataResponse=await response.json();if(response.ok){// Filter products by userId\nconst filteredProducts=dataResponse.data.filter(product=>product.userId===userId);setAllProduct(filteredProducts||[]);}else{toast.error(dataResponse.message||\"Failed to fetch products\");}}catch(error){console.error(\"Failed to fetch products:\",error);toast.error(\"Failed to fetch products\");}};useEffect(()=>{fetchAllProduct();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-black py-2 px-4 flex justify-between items-center left-20\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-bold text-lg text-center text-white\",children:\"Produits\"}),/*#__PURE__*/_jsx(\"button\",{className:\"border-2 w-40 border-white text-white hover:bg-green-600 hover:text-white transition-all py-1 px-3 rounded-full\",onClick:()=>setOpenUploadProduct(true),children:\"Nouveau produit\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center flex-wrap gap-5 py-4 h-[calc(100vh-190px)] overflow-y-scroll\",children:allProduct.map((product,index)=>{return/*#__PURE__*/_jsx(AdminProductCard,{data:product,fetchdata:fetchAllProduct},index+\"allProduct\");})}),openUploadProduct&&/*#__PURE__*/_jsx(UploadProduct,{onClose:()=>setOpenUploadProduct(false),fetchData:fetchAllProduct})]});};export default AllProducts;","map":{"version":3,"names":["React","useEffect","useState","UploadProduct","SummaryApi","AdminProductCard","toast","jsx","_jsx","jsxs","_jsxs","AllProducts","openUploadProduct","setOpenUploadProduct","allProduct","setAllProduct","fetchAllProduct","token","localStorage","getItem","userId","JSON","parse","atob","split","_id","response","fetch","url","method","headers","Authorization","concat","dataResponse","json","ok","filteredProducts","data","filter","product","error","message","console","children","className","onClick","map","index","fetchdata","onClose","fetchData"],"sources":["C:/Users/Wendy/OneDrive/Desktop/PROJET/MACTOB_STORE/frontend/src/pages/AllProducts.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport UploadProduct from '../components/UploadProduct';\r\nimport SummaryApi from '../common';\r\nimport AdminProductCard from '../components/AdminProductCard';\r\nimport { toast } from 'react-toastify';\r\n\r\nconst AllProducts = () => {\r\n  const [openUploadProduct, setOpenUploadProduct] = useState(false);\r\n  const [allProduct, setAllProduct] = useState([]);\r\n\r\n  const fetchAllProduct = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const userId = JSON.parse(atob(token.split('.')[1]))._id; // Decode token to get userId\r\n\r\n    try {\r\n      const response = await fetch(SummaryApi.allProduct.url, {\r\n        method: 'GET',\r\n        headers: {\r\n          \"content-type\": \"application/json\",\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      const dataResponse = await response.json();\r\n\r\n      if (response.ok) {\r\n        // Filter products by userId\r\n        const filteredProducts = dataResponse.data.filter(product => product.userId === userId);\r\n        setAllProduct(filteredProducts || []);\r\n      } else {\r\n        toast.error(dataResponse.message || \"Failed to fetch products\");\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch products:\", error);\r\n      toast.error(\"Failed to fetch products\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchAllProduct();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <div className='bg-black py-2 px-4 flex justify-between items-center left-20'>\r\n        <h2 className='font-bold text-lg text-center text-white'>Produits</h2>\r\n        <button\r\n          className='border-2 w-40 border-white text-white hover:bg-green-600 hover:text-white transition-all py-1 px-3 rounded-full'\r\n          onClick={() => setOpenUploadProduct(true)}>Nouveau produit</button>\r\n      </div>\r\n\r\n      {/** all product */}\r\n      <div className='flex items-center justify-center flex-wrap gap-5 py-4 h-[calc(100vh-190px)] overflow-y-scroll'>\r\n        {\r\n          allProduct.map((product, index) => {\r\n            return (\r\n              <AdminProductCard data={product} key={index + \"allProduct\"} fetchdata={fetchAllProduct} />\r\n            );\r\n          })\r\n        }\r\n      </div>\r\n\r\n      {/** upload product component */}\r\n      {\r\n        openUploadProduct && (\r\n          <UploadProduct onClose={() => setOpenUploadProduct(false)} fetchData={fetchAllProduct} />\r\n        )\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AllProducts;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}